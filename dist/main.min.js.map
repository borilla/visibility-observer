{"version":3,"file":"main.min.js","sources":["../src/intersection-observer-wrapper.js","../src/vertical-visibility-observer.js","../src/main.js"],"sourcesContent":["function IntersectionObserverWrapper(window) {\n\tthis._intersectionObserver = new window.IntersectionObserver(this._handleIntersectionChanged.bind(this));\n\tthis._observing = new Map();\n}\n\nIntersectionObserverWrapper.prototype.observe = function (element, onVisibilityChanged) {\n\tthis._intersectionObserver.observe(element);\n\tthis._observing.set(element, onVisibilityChanged);\n};\n\nIntersectionObserverWrapper.prototype.unobserve = function (element) {\n\tthis._intersectionObserver.unobserve(element);\n\tthis._observing.delete(element);\n};\n\nIntersectionObserverWrapper.prototype._handleIntersectionChanged = function (entries) {\n\tconst observing = this._observing;\n\n\tentries.forEach(function (entry) {\n\t\tconst isVisible = entry.intersectionRatio > 0;\n\t\tconst element = entry.target;\n\t\tconst onVisibilityChanged = observing.get(element);\n\n\t\tonVisibilityChanged(isVisible, element);\n\t});\n};\n\nmodule.exports = IntersectionObserverWrapper;\n","function VerticalVisibilityObserver(window) {\n\tthis._window = window;\n\tthis._viewport = { top: 0, bottom: 0 };\n\tthis._observing = new Map();\n\tthis._handleResize = this._handleResize.bind(this);\n\tthis._handleScroll = this._handleScroll.bind(this);\n}\n\nVerticalVisibilityObserver.prototype.observe = function (element, onVisibilityChanged) {\n\tconst info = { top: 0, bottom: 0, isVisible: null, onVisibilityChanged };\n\n\tif (this._observing.size === 0) {\n\t\tthis._updateViewport();\n\t\tthis._addListeners();\n\t}\n\n\tthis._observing.set(element, info);\n\tthis._updateElement(info, element);\n};\n\nVerticalVisibilityObserver.prototype.unobserve = function (element) {\n\tthis._observing.delete(element);\n\n\tif (this._observing.size === 0) {\n\t\tthis._removeListeners();\n\t}\n};\n\nVerticalVisibilityObserver.prototype._addListeners = function () {\n\t// TODO: Add load and/or orientationchange events?\n\tthis._window.addEventListener('resize', this._handleResize);\n\tthis._window.addEventListener('scroll', this._handleScroll);\n};\n\nVerticalVisibilityObserver.prototype._removeListeners = function () {\n\tthis._window.removeEventListener('resize', this._handleResize);\n\tthis._window.removeEventListener('scroll', this._handleScroll);\n};\n\nVerticalVisibilityObserver.prototype._updateViewport = function () {\n\tconst top = this._viewport.top = this._window.scrollY;\n\tconst height = this._window.innerHeight;\n\n\tthis._viewport.bottom = top + height;\n};\n\nVerticalVisibilityObserver.prototype._updateElement = function (info, element) {\n\tinfo.top = element.offsetTop;\n\tinfo.bottom = info.top + element.offsetHeight;\n\n\tthis._updateElementVisibilty(info, element);\n};\n\nVerticalVisibilityObserver.prototype._updateElementVisibilty = function (info, element) {\n\tconst viewport = this._viewport;\n\tconst isVisible = info.top < viewport.bottom && info.bottom > viewport.top;\n\n\tif (isVisible !== info.isVisible) {\n\t\tinfo.isVisible = isVisible;\n\t\tinfo.onVisibilityChanged(isVisible, element);\n\t}\n};\n\nVerticalVisibilityObserver.prototype._handleResize = function () {\n\tthis._updateViewport();\n\tthis._observing.forEach(this._updateElement, this);\n};\n\nVerticalVisibilityObserver.prototype._handleScroll = function () {\n\tthis._updateViewport();\n\tthis._observing.forEach(this._updateElementVisibilty, this);\n};\n\nmodule.exports = VerticalVisibilityObserver;\n","const IntersectionObserverWrapper = require('./intersection-observer-wrapper');\nconst VerticalVisibilityObserver = require('./vertical-visibility-observer');\n\nmodule.exports = function (window) {\n\tif ('IntersectionObserver' in window && 'IntersectionObserverEntry' in window) {\n\t\treturn new IntersectionObserverWrapper(window);\n\t}\n\n\treturn new VerticalVisibilityObserver(window);\n};\n"],"names":["IntersectionObserverWrapper","window","_intersectionObserver","IntersectionObserver","this","_handleIntersectionChanged","bind","_observing","Map","VerticalVisibilityObserver","_window","_viewport","top","bottom","_handleResize","_handleScroll","prototype","observe","element","onVisibilityChanged","set","unobserve","delete","entries","observing","forEach","entry","isVisible","intersectionRatio","target","get","info","size","_updateViewport","_addListeners","_updateElement","_removeListeners","addEventListener","removeEventListener","scrollY","height","innerHeight","offsetTop","offsetHeight","_updateElementVisibilty","viewport"],"mappings":"8LAAA,SAASA,EAA4BC,QAC/BC,EAAwB,IAAID,EAAOE,qBAAqBC,KAAKC,EAA2BC,KAAKF,YAC7FG,EAAa,IAAIC,ICFvB,SAASC,EAA2BR,QAC9BS,EAAUT,OACVU,GAAcC,IAAK,EAAGC,OAAQ,QAC9BN,EAAa,IAAIC,SACjBM,EAAgBV,KAAKU,EAAcR,KAAKF,WACxCW,EAAgBX,KAAKW,EAAcT,KAAKF,MDA9CJ,EAA4BgB,UAAUC,QAAU,SAAUC,EAASC,QAC7DjB,EAAsBe,QAAQC,QAC9BX,EAAWa,IAAIF,EAASC,IAG9BnB,EAA4BgB,UAAUK,UAAY,SAAUH,QACtDhB,EAAsBmB,UAAUH,QAChCX,EAAWe,OAAOJ,IAGxBlB,EAA4BgB,UAAUX,EAA6B,SAAUkB,OACtEC,EAAYpB,KAAKG,IAEfkB,QAAQ,SAAUC,OACnBC,EAAYD,EAAME,kBAAoB,EACtCV,EAAUQ,EAAMG,OACML,EAAUM,IAAIZ,GAEtBS,EAAWT,MAIjC,MAAiBlB,ECnBjBS,EAA2BO,UAAUC,QAAU,SAAUC,EAASC,OAC3DY,GAASnB,IAAK,EAAGC,OAAQ,EAAGc,UAAW,KAAMR,uBAEtB,IAAzBf,KAAKG,EAAWyB,YACdC,SACAC,UAGD3B,EAAWa,IAAIF,EAASa,QACxBI,EAAeJ,EAAMb,IAG3BT,EAA2BO,UAAUK,UAAY,SAAUH,QACrDX,EAAWe,OAAOJ,GAEM,IAAzBd,KAAKG,EAAWyB,WACdI,KAIP3B,EAA2BO,UAAUkB,EAAgB,gBAE/CxB,EAAQ2B,iBAAiB,SAAUjC,KAAKU,QACxCJ,EAAQ2B,iBAAiB,SAAUjC,KAAKW,IAG9CN,EAA2BO,UAAUoB,EAAmB,gBAClD1B,EAAQ4B,oBAAoB,SAAUlC,KAAKU,QAC3CJ,EAAQ4B,oBAAoB,SAAUlC,KAAKW,IAGjDN,EAA2BO,UAAUiB,EAAkB,eAChDrB,EAAMR,KAAKO,EAAUC,IAAMR,KAAKM,EAAQ6B,QACxCC,EAASpC,KAAKM,EAAQ+B,iBAEvB9B,EAAUE,OAASD,EAAM4B,GAG/B/B,EAA2BO,UAAUmB,EAAiB,SAAUJ,EAAMb,KAChEN,IAAMM,EAAQwB,YACd7B,OAASkB,EAAKnB,IAAMM,EAAQyB,kBAE5BC,EAAwBb,EAAMb,IAGpCT,EAA2BO,UAAU4B,EAA0B,SAAUb,EAAMb,OACxE2B,EAAWzC,KAAKO,EAChBgB,EAAYI,EAAKnB,IAAMiC,EAAShC,QAAUkB,EAAKlB,OAASgC,EAASjC,IAEnEe,IAAcI,EAAKJ,cACjBA,UAAYA,IACZR,oBAAoBQ,EAAWT,KAItCT,EAA2BO,UAAUF,EAAgB,gBAC/CmB,SACA1B,EAAWkB,QAAQrB,KAAK+B,EAAgB/B,OAG9CK,EAA2BO,UAAUD,EAAgB,gBAC/CkB,SACA1B,EAAWkB,QAAQrB,KAAKwC,EAAyBxC,OAGvD,MAAiBK,SCtEA,SAAUR,SACtB,yBAA0BA,GAAU,8BAA+BA,EAC/D,IAAID,EAA4BC,GAGjC,IAAIQ,EAA2BR"}